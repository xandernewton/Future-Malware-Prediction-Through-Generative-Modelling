import sys

sys.path.append("H:\\MSc-project\\torch-fidelity")
from torch_fidelity import calculate_metrics
import torchvision.datasets as dset
from torchvision import transforms as T


def compute_FID(path_1, path_2):
    transform = T.Compose([T.CenterCrop(229), T.Resize(229), T.ToTensor()])
    dataset_1 = dset.ImageFolder(root=path_1, transform=transform)
    dataset_2 = dset.ImageFolder(root=path_2, transform=transform)
    metrics_dict = calculate_metrics(dataset_1, dataset_2, cuda=True, fid=True, isc=False, kid=False, verbose=True,
                                     feature_extractor='inception-v3-compat', save_cpu_ram=True)

    print(f"{metrics_dict}")
    return metrics_dict


if __name__ == '__main__':
    # Each input can be either a string (path to images, registered input), or a Dataset instance
    input1 = "H:\\malimg\\malimg_paper_dataset_imgs"
    input2 = "C:\\Users\\ahrn1e19\\vae_images"
    compute_FID(input1, input2)
