import sys
sys.path.append("H:\\MSc-project\\torch-fidelity")
from torch_fidelity import calculate_metrics
import torch
import torchvision.datasets as dset
from torchvision import transforms as T



# Each input can be either a string (path to images, registered input), or a Dataset instance
input1 = "H:\\malimg\\malimg_paper_dataset_imgs\\Adialer.C"
input2 = "C:\\Users\\ahrn1e19\\logs\\VanillaVAE\\version_0"


transform = T.Compose([T.CenterCrop(229), T.Resize(229) ,T.ToTensor()])
dataset_1 = dset.ImageFolder(root=input1, transform = transform)
dataset_2 = dset.ImageFolder(root=input2, transform = transform)


metrics_dict = calculate_metrics(dataset_1, dataset_2, cuda=True, fid=True, isc=False,  kid=False, verbose=True,
                                 feature_extractor='inception-v3-compat-malware', save_cpu_ram=True)

print(metrics_dict)